<!-- 1. Contenedor Principal -->
<div class="list-container">
  
  <!-- 2. Encabezado y Buscador -->
  <div class="list-header">
    <div class="header-content">
      <h1 class="title">Listado de Servicios</h1>
      <p class="subtitle">Gestiona, edita y elimina los servicios de tu barbería.</p>
      
      <!-- 
        El Buscador Reactivo:
        - [(ngModel)]="searchTerm" actualiza el signal en tiempo real.
        - (ngModelChange)="$event" es necesario para que el signal se entere.
      -->
      <div class="search-bar-wrapper">
        <i class="bi bi-search search-icon"></i>
        <input 
          type="text" 
          class="form-control search-bar" 
          placeholder="Buscar por nombre o descripción..."
          [ngModel]="searchTerm()"
          (ngModelChange)="searchTerm.set($event)">
      </div>
    </div>
    <a routerLink="/admin" class="btn btn-outline-light btn-sm btn-back">
      <i class="bi bi-arrow-left me-1"></i> Volver al Panel
    </a>
  </div>

  <!-- 3. El Listado de Servicios -->
  <div class="services-list">
    
    <!-- 
      El bucle @for itera sobre el signal COMPUTADO 'filteredServices()'.
      Esto es increíblemente rápido y reactivo.
    -->
    @for (servicio of filteredServices(); track servicio.id; let i = $index) {
      <div class="service-item" [style.animation-delay.ms]="i * 50">
        <div class="service-info">
          <span class="service-category">{{ servicio.objCategoria?.nombre || 'Sin Cat.' }}</span>
          <h5 class="service-name">{{ servicio.nombre }}</h5>
          <p class="service-description">{{ servicio.descripcion | slice:0:100 }}...</p>
        </div>
        
        <div class="service-details">
          <span class="service-price">{{ servicio.precio | currency:'USD':'$' }}</span>
          <span class="service-duration">{{ servicio.duracionMinutos }} min.</span>
        </div>
        
        <div class="service-actions">
          <button class="btn btn-action btn-edit" (click)="onEdit(servicio)">
            <i class="bi bi-pencil-fill"></i> Editar
          </button>
          <button class="btn btn-action btn-delete" (click)="onDelete(servicio)">
            <i class="bi bi-trash-fill"></i>
          </button>
        </div>
      </div>
    } @empty {
      <!-- Esto se muestra si 'filteredServices()' está vacío -->
      <div class="empty-state">
        <i class="bi bi-box-seam-fill"></i>
        @if (searchTerm() === '') {
          <p>No hay servicios registrados.</p>
        } @else {
          <p>No se encontraron servicios para "<b>{{ searchTerm() }}</b>".</p>
        }
      </div>
    }

  </div>
</div>


<!-- 
  4. El Modal de Edición 
  Se renderiza condicionalmente usando @if.
-->
@if (selectedService()) {
  <app-editar-servicio-modal 
    [servicio]="selectedService()!" 
    (close)="onModalClose()"
    (save)="onModalSave()">
  </app-editar-servicio-modal>
}
